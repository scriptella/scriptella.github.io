<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_191) on Fri Oct 04 08:56:33 PDT 2019 -->
<title>scriptella.jdbc (Scriptella API Documentation)</title>
<meta name="date" content="2019-10-04">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="scriptella.jdbc (Scriptella API Documentation)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../scriptella/interactive/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../scriptella/spi/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?scriptella/jdbc/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;scriptella.jdbc</h1>
<div class="docSummary">
<div class="block">Scriptella JDBC Bridge.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../scriptella/jdbc/SqlTokenizer.html" title="interface in scriptella.jdbc">SqlTokenizer</a></td>
<td class="colLast">
<div class="block">This interface provides a contract to iterate SQL statements.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../scriptella/jdbc/GenericDriver.html" title="class in scriptella.jdbc">GenericDriver</a></td>
<td class="colLast">
<div class="block">Generic adapter for JDBC drivers.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../scriptella/jdbc/JdbcConnection.html" title="class in scriptella.jdbc">JdbcConnection</a></td>
<td class="colLast">
<div class="block">Represents a JDBC connection.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../scriptella/jdbc/JdbcUtils.html" title="class in scriptella.jdbc">JdbcUtils</a></td>
<td class="colLast">
<div class="block">Utility class JDBC related operations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../scriptella/jdbc/ParametersParser.html" title="class in scriptella.jdbc">ParametersParser</a></td>
<td class="colLast">
<div class="block">Parses parameter expressions in SQL statements.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../scriptella/jdbc/ResultSetAdapter.html" title="class in scriptella.jdbc">ResultSetAdapter</a></td>
<td class="colLast">
<div class="block">Represents SQL query result set as <a href="../../scriptella/spi/ParametersCallback.html" title="interface in scriptella.spi"><code>ParametersCallback</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../scriptella/jdbc/SqlParserBase.html" title="class in scriptella.jdbc">SqlParserBase</a></td>
<td class="colLast">
<div class="block">Customizable SQL parser.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../scriptella/jdbc/SqlReaderTokenizer.html" title="class in scriptella.jdbc">SqlReaderTokenizer</a></td>
<td class="colLast">
<div class="block">Reader based SQL tokenizer.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../scriptella/jdbc/JdbcException.html" title="class in scriptella.jdbc">JdbcException</a></td>
<td class="colLast">
<div class="block">Unchecked wrapper for SQL exceptions or other SQL related errors.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package scriptella.jdbc Description">Package scriptella.jdbc Description</h2>
<div class="block">Scriptella JDBC Bridge.
<p>As specified in Service Provider API all JDBC drivers are registered
    via this bridge. This procedure is transparent to end user,
    he only have to specify jdbc driver class name or an alias.</p>
<h2>General information</h2>
<table>
    <tr>
        <td><b>Driver class:</b></td><td><code>JDBC driver class name</code></td>
    </tr>
    <tr>
        <td><b>URL:</b></td><td>JDBC driver URL, e.g. <code>jdbc:mydb:...</code></td>
    </tr>
    <tr>
        <td><b>Runtime dependencies:</b></td><td><code>Set of libraries required by the JDBC driver.</code></td>
    </tr>
</table>
<h2>JDBC Bridge Properties</h2>
<p>JDBC bridge makes the following configuration properties available in configuration element:</p>
<table border="1">
    <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Required</th>
    </tr>
    <tr>
        <td>statement.cache</td>
        <td>Size of prepared statements cache or 0 to disable statement caching.</td>
        <td>No, the default value is 64.</td>
    </tr>
    <tr>
        <td>statement.separator</td>
        <td>SQL statements separator string. Similar to Ant delimiter property.</td>
        <td>No, the default value is <code>;</code> (semicolon).</td>
    </tr>
    <tr>
        <td>statement.batchSize</td>
        <td>Activates batching with specified batch size. See <a href="#batching">Batching</a> section for more details.</td>
        <td>No, the default value is <code>0</code> (batching is disabled). Since version 1.1.</td>
    </tr>
    <tr>
        <td>statement.fetchSize</td>
        <td>Gives the JDBC driver a hint as to the number of rows that should be fetched from the database
            when more rows are needed for <code>ResultSet</code>. 
            See <a href="http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#setFetchSize(int)">setFetchSize</a> JavaDoc for additional details. Since version 1.1.</td>
        <td>No, the default value is <code>0</code>.</td>
    </tr>
    <tr>
        <td>flushBeforeQuery</td>
        <td>True if flush of current connection need to be performed before query execution. 
        Flushing might be necessary in batch mode, in order to send pending batches before executing a query. See <a href="#batching">Batching</a> section for more details.</td>
        <td>No, the default value is <code>false</code>. Since version 1.1.</td>
    </tr>
    <tr>
        <td>statement.separator.singleline</td>
        <td>True if the delimiter should only be recognized on a line by itself. Leading and trailing whitespaces are
        ignored when searching for a separator in <code>statement.separator.singleline=true</code> mode.
            Similar to Ant delimitertype property.</td>
        <td>No, the default value is <code>false</code>.</td>
    </tr>
    <tr>
        <td>keepformat</td>
        <td>True if the original SQL formatting should be preserved.
        <p>This property is similar to Ant keepformat property except that Oracle-style hints (?*+ hint */) are always preserved in Scriptella.</p></td>
        <td>No, the default value is <code>false</code>, i.e. extra whitespaces and comments removed.</td>
    </tr>
    <tr>
        <td>transaction.isolation</td>
        <td>Transaction isolation level name or an integer value according to <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Connection">java.sql.Connection</a>
            javadoc.
            The valid level names are: <code>READ_UNCOMMITTED</code>, <code>READ_COMMITTED</code>,
            <code>REPEATABLE_READ</code> and <code>SERIALIZABLE</code>.
        <td>No, the default value is driver specific.</td>
    </tr>
    <tr>
        <td>autocommit</td>
        <td>True if connection is in auto-commit mode. If a connection is in auto-commit mode, then all its SQL statements will be executed and committed
                as individual transactions.See also autocommit.size.
            <p><em>Note:</em> In general avoid setting autocommit to true, because in this case an ETL process cannot be rolled back correctly.
                Use this parameter only for performance critical operations (bulk inserts etc.).</p>
        </td>
        <td>No, the default value is <code>false</code>.</td>
    </tr>
        <tr>
        <td>autocommit.size</td>
        <td>If positive, specifies the number of statements to execute before producing implicit commit,
            i.e. controls how much data is committed in its batches.
            <p><em>Notes:</em>
                <ul>
                <li>In general avoid using autocommit.size, because in this case an ETL process cannot be rolled back correctly.
                Use this parameter only for performance critical operations (bulk inserts etc.).</li>
                <li>If the <code>autocommit</code> is <code>true</code>,
                    then setting <code>autocommit.size</code> has no effect</li>
                </ul>

            </p>
        </td>
        <td>No, the default value is <code>false</code>.</td>
    </tr>

</table>
<h2>Properties Substitution</h2>
The bridge supports standard ${} variables expansion and
allows to set prepared statement parameters via ?{} syntax.
<p>Example:
<pre><code>
var=_name
id=11
--------------------------------------
select * FROM table${var} where id=?id
-- is transformed to a JDBC prepared statement---
select * FROM table_name where id=?
-- where parameter id=11
</code></pre>
<p><u>Notes:</u>
<ul>
    <li>$ prefixed expressions are substituted in all parts except comments.</li>
    <li>? prefixed expressions are not substituted inside quotes and comments.</li>
    <br>Example:
    <code>
    <pre>--only ${prop} and ?surname are handled
     SELECT * FROM "Table" WHERE NAME="?John${prop}" and SURNAME=?surname;
    </pre></code>

</ul>

<h2><a name="batching">Batching</a></h2>
JDBC batching is a very important feature which allows sending multiple commands to the database in one call.
Scriptella batching was introduced in version 1.1 and controlled by <code>statement.batchSize</code> parameter. The value of this parameter specifies number of statements
to be combined in a batch before sending it to the database.
<p>Please note that behavior for batching depends on the type of statements processed, as the result non-prepared
SQL statements (statements without ? parameters) are processed in a single batch group different from parameterized prepared
SQL statements. The grouping rules are the following:
<ul>
    <li>Normal(non-prepared) statements are always grouped in a single batch per ETL script element.</li>
    <li>Parameterized prepared statement use SQL text as a group key, i.e. different statements go into different groups
        what may introduce not always desired behavior.</li>
</ul>
<strong>Notes:</strong>
<ul>
<li>As the result, mixing parameterized (prepared statements) with normal statements in a single ETL element is NOT RECOMMENDED for batch-mode,
because statements are processed in different batch groups and results might be unpredictable. The recommended approach is to create 
2 connections: one for non-batched operations like DLL scripts, or non-parameterized statement and one for bulk load.
<li>If data is updated in a batch and then selected using the same connection, 
flushBeforeQuery connection parameter must be enabled in order to flush pending batch updates before querying the database.
<li>When querying large tables, consider using statement.fetchSize to increase number of records fetched per each request to the database. 
</ul>

<p>The following 2 examples show a RECOMMENDED way of batching. Example 1. Extract->Load using PreparedStatement.setParameters/addBatch :
<code><pre>

&lt;connection id="in" url="$db_url" user="$db_user" password="$db_password"&gt;
    #Fetch larger number of rows per DB request
    statement.fetchSize=1000
&lt;/connection&gt;
&lt;connection id="out" url="$db_url" user="$db_user" password="$db_password"&gt;
    statement.batchSize=5
&lt;/connection&gt;
&lt;query connection-id="in"&gt;
    SELECT * from Bug
    &lt;script connection-id="out"&gt;
        INSERT INTO Bug VALUES (?ID, ?priority, ?summary, ?status);
    &lt;/script&gt;
&lt;/query&gt;
</pre></code>
Example 2. Bulk load of non-prepared statements (without ?, but $ are allowed)
<code><pre>
&lt;script connection-id="out"&gt;
    INSERT INTO Bug VALUES (1, 'One');
    INSERT INTO Bug VALUES (2, 'Two');
    INSERT INTO Bug VALUES (3, '$Value');
    ....
&lt;/script&gt;
</pre></code>
<h2>Examples</h2>
<code><pre>
    &lt;connection id="in" driver="org.hsqldb.jdbcDriver" url="jdbc:hsqldb:file:tmp" user="sa" classpath="hsqldb.jar"&gt;
        #Disable cache - just for example
        statement.cache=0
        #Set SQL statements separator
        statement.separator=;
    &lt;/connection>

    &lt;connection id="out" driver="h2" url="jdbc:h2:file:out" user="sa"/&gt;
    &lt;query connection-id="in"&gt;
        SELECT * from Bug
        &lt;script connection-id="out"&gt;
            INSERT INTO Bug VALUES (?ID, ?priority, ?summary, ?status);
        &lt;/script&gt;
    &lt;/query&gt;
</pre></code></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../scriptella/interactive/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../scriptella/spi/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?scriptella/jdbc/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
                <i>Copyright &#169; Copyright 2006-2019 The <a href="http://scriptella.org">Scriptella Project</a> Team.</i></small></p>
</body>
</html>
